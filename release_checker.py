from datetime import datetime
import requests

api_key = '3f6bad0655f06b961a185e888a633bcb3702ecdd9e68e44167106420ed62a349'
RATE_LIMIT_PER_SECOND = 3.33
DELAY = 1 / RATE_LIMIT_PER_SECOND

def get_movie_id(title):
    search_url = f'https://api.trakt.tv/search/movie?query={title}'

    headers = {
        'Content-Type': 'application/json',
        'trakt-api-key': api_key,
        'trakt-api-version': '2'
    }

    response = requests.get(search_url, headers=headers)
    data = response.json()

    if data:
        movie_id = data[0]['movie']['ids']['trakt']
        return movie_id
    else:
        return None

def check_release_status(movie_id):
    releases_url = f'https://api.trakt.tv/movies/{movie_id}/releases/'

    headers = {
        'Content-Type': 'application/json',
        'trakt-api-key': api_key,
        'trakt-api-version': '2'
    }

    response = requests.get(releases_url, headers=headers)
    data = response.json()

    current_date = datetime.now()

    if isinstance(data, list):
        for release in data:
            if release['release_type'].lower() == 'digital':
                release_date = release.get('release_date')
                # Parse the release date string to a datetime object
                release_date = datetime.strptime(release_date, "%Y-%m-%d") if release_date else None

                if release_date and release_date.date() <= current_date.date():
                    return True
        return False
    else:
        return False

def check_movies_and_add_to_list(movie_titles):
    released_movies = []

    for title in movie_titles:
        movie_id = get_movie_id(title)
        print(f'Checking {title}, movie id: {movie_id}')
        if movie_id is not None and check_release_status(movie_id):
            released_movies.append(title)

    return released_movies

movie_title = ['Seven Samurai', 'Harakiri', 'Yojimbo', 'North by Northwest', 'Evangelion: 3.0+1.0 Thrice Upon a Time', 'Safety Last!', 'Sherlock Jr.', 'The General', 'Oldboy', 'Aliens', 'Mad Max: Fury Road', 'The Wild Bunch', 'Platoon', 'The Hidden Fortress', 'Aguirre, the Wrath of God', 'Demon Slayer -Kimetsu no Yaiba- The Movie: Mugen Train', 'Sanjuro', 'Stagecoach', 'Neon Genesis Evangelion: The End of Evangelion', 'The French Connection', 'Terminator 2: Judgment Day', 'Children of Men', 'The Terminator', 'A Trip to the Moon', 'RRR', 'Everything Everywhere All at Once', 'John Wick: Chapter 4', 'Touching the Void', 'Letters from Iwo Jima', 'Heat', 'Kill Bill: Vol. 2', 'Riders of Justice', 'Scarface', 'Logan', 'Bacurau', 'White Heat', 'Bonnie and Clyde', 'The Killer', 'The Man from Nowhere', 'Cell 211', 'Kill Bill: Vol. 1', 'Blade Runner', 'The Matrix', 'Justice League Dark: Apokolips War', 'Bob le Flambeur', 'Love Exposure', 'Hard Boiled', 'A Bittersweet Life', 'Key Largo', 'Lady Snowblood', 'Brother', 'United 93', 'Hot Fuzz', 'The Thief of Bagdad', 'A Night to Remember', 'The Great Silence', 'Scarface', 'A Fistful of Dollars', 'Diva', 'Sin Nombre', 'Akira', 'Ghost in the Shell', 'Blade Runner 2049', 'Baby Driver', '3:10 to Yuma', 'Drive', 'Zulu', 'To Live and Die in L.A.', '1917', 'John Wick: Chapter 3 - Parabellum', 'Steamboat Bill, Jr.', 'Sonatine', 'Sholay', 'Fallen Angels', 'Sword of the Stranger', 'Ninja Scroll', 'Midnight Run', 'Enter the Dragon', 'Elite Squad: The Enemy Within', 'Dirty Harry', 'Kung Fu Hustle', 'Mad Max 2', 'Train to Busan', 'The 36th Chamber of Shaolin', 'The Legend of Drunken Master', 'Pusher II', "Winchester '73", 'Battle Royale', 'Speed', 'Braveheart', 'The Magnificent Seven', 'Die Hard', 'Black Hawk Down', 'The Witch: Part 1. The Subversion', 'John Wick: Chapter 2', "Mortal Kombat Legends: Scorpion's Revenge", 'Raazi', 'Captain Blood', 'Bring Me the Head of Alfredo Garcia', 'A Better Tomorrow', 'The Taking of Pelham One Two Three', "Knockin' on Heaven's Door", 'Assault on Precinct 13', 'Bāhubali: The Beginning', 'Headhunters', 'Run Lola Run', 'The Crow', 'End of Watch', 'District 9', 'Sicario', 'The Revenant', 'Soorarai Pottru', 'Batman: The Long Halloween, Part Two', 'The Harder They Fall', 'A History of Violence', 'Joint Security Area', 'Zatoichi', 'Lock, Stock and Two Smoking Barrels', 'True Romance', 'The Train', 'Collateral', 'Thief', 'Léon: The Professional', 'Jackass Forever', 'A Taxi Driver', 'The Court Jester', 'The Guns of Navarone', 'The Ballad of Cable Hogue', 'Hera Pheri', 'Drug War', "King of Devil's Island", 'The Age of Shadows', 'Tae Guk Gi: The Brotherhood of War', 'Berserk: The Golden Age Arc III - The Advent', 'Phineas and Ferb: The Movie: Across the 2nd Dimension', 'The Guard', 'I Saw the Devil', 'Three Kings', 'Munich', 'The Last of the Mohicans', 'Ip Man', 'Looper', 'Kantara', 'Ponniyin Selvan: Part II', 'Old Henry', 'Prey', 'All Quiet on the Western Front', 'The Dirty Dozen', 'RoboCop', 'Ip Man 2', 'The Fighter', 'No Way Out', 'Nobody', 'The Witcher: Nightmare of the Wolf', 'Brawl in Cell Block 99', 'El Camino: A Breaking Bad Movie', 'Foreign Correspondent', 'May God Save Us', 'Mesrine: Killer Instinct', 'Evangelion: 2.0 You Can (Not) Advance', 'In the Line of Fire', "'71", 'Crimson Tide', 'Kung Fury', 'V for Vendetta', 'Gladiator', "Zack Snyder's Justice League", 'The Dam Busters', 'The Blues Brothers', 'Training Day', 'The Suicide Squad', 'Ip Man 4: The Finale', 'Upgrade', 'Bullet in the Head', 'A Touch of Sin', 'Riki-Oh: The Story of Ricky', 'A Wednesday!', 'Runaway Train', 'The Day of the Beast', 'Get Carter', 'Mesrine: Public Enemy #1', 'Rurouni Kenshin Part III: The Legend Ends', 'Berserk: The Golden Age Arc II - The Battle for Doldrey', 'The Proposition', 'Red Cliff', 'Repo Man', 'Marshland', 'Open Range', 'Cowboy Bebop: The Movie', 'Grindhouse', 'Layer Cake', 'First Blood', 'Face/Off', 'Eye in the Sky', 'Total Recall', 'Predestination', 'Rush', 'John Wick', 'The Memory of a Killer', 'The Last Duel', 'The Unbearable Weight of Massive Talent', 'Udta Punjab', 'Deadpool', 'Extreme Job', 'Uri: The Surgical Strike', 'Kaithi', 'Gun Crazy', 'Days of Glory', 'Deep Cover', 'Once Upon a Time in China II', 'Pusher 3', 'Bhaag Milkha Bhaag', '36th Precinct', 'Infernal Affairs II', 'War of the Arrows', 'Red Cliff II', 'The Yellow Sea', 'Pusher', 'Along with the Gods: The Two Worlds', 'The Baader Meinhof Complex', 'Berserk: The Golden Age Arc I - The Egg of the King', 'Vampire Hunter D: Bloodlust', 'Evangelion: 1.0 You Are (Not) Alone', 'The Assassination of Jesse James by the Coward Robert Ford', 'The Raid 2', 'Tombstone', 'Lethal Weapon 2', "The World's End", 'American Sniper', 'The Nice Guys', "Guy Ritchie's The Covenant", 'Blood Diamond', 'The Misfits', 'Beverly Hills Cop', 'In China They Eat Dogs', 'Wrath of Man', 'The Northman', "The Wolf's Call", 'Deadpool 2', 'Game Night', 'A Prayer Before Dawn', 'The Night Comes for Us', 'Hotel Mumbai', 'The Navigator', 'Destry Rides Again', 'The Sword of Doom', 'Ride the High Country', "Twelve O'Clock High", 'Black Friday', 'El Infierno', 'Andaz Apna Apna', 'Flame & Citron', 'Always', 'Shogun Assassin', 'Miracle Mile', 'North Face', 'Fanaa', 'Airlift', 'The Admiral: Roaring Currents', 'Police Story 3: Super Cop', 'Ink', 'Set It Off', 'Casualties of War', 'Juice', 'Fist of Fury', 'The Good, the Bad, the Weird', 'Ong Bak: Muay Thai Warrior', 'Grosse Pointe Blank', 'Flags of Our Fathers', 'The Warriors', 'Escape from New York', 'The Last Samurai', 'Predator', 'Spy', 'Mosul', 'Rumble Fish', 'Undisputed III: Redemption', 'Stripes', 'Lust, Caution', 'Ready or Not', 'The Gentlemen', 'The Enemy Below', 'Delhi Belly', 'State of Grace', 'Point Blank', 'Neon Genesis Evangelion: Death and Rebirth', 'The Connection', 'Vanishing Point', 'Mongol: The Rise of Genghis Khan', 'They Call Me Jeeg', 'Ichi the Killer', 'El Mariachi', 'A Most Violent Year', 'The Negotiator', 'They Live', 'Attack the Block', 'Point Break', 'Natural Born Killers', 'Falling Down', 'Apocalypto', 'The Rock', 'Tropic Thunder', 'Patriots Day', 'Watchmen', 'The Big Easy', 'Dog Soldiers', 'Batman & Mr. Freeze: SubZero', 'Courage Under Fire', 'The Sea Hawk', 'Brother 2', 'Mad Max', 'Hamburger Hill', 'The Matrix Reloaded', 'The Great Race', 'Memoir of a Murderer', 'Suicide Squad: Hell to Pay', 'High Sierra', 'Run Silent, Run Deep', 'Persuasion', 'SPL: Kill Zone', 'Cross of Iron', 'New World', 'OSS 117: Cairo, Nest of Spies', 'District B13', "Dragon Ball Z: Resurrection 'F'", 'Bronson', 'We Were Soldiers', 'The Guest', 'Justice League Dark', 'Ronin', 'The Raid', 'Enemy of the State', '22 Jump Street', 'Athena', 'Shershaah', 'Chocolate', 'Planet Terror', 'Sands of Iwo Jima', 'Violent Cop', 'New Jack City', 'T-34', 'Until the End of the World', 'The Gangster, the Cop, the Devil', 'Avengement', 'The Mark of Zorro', "Von Ryan's Express", 'Anniyan', 'Last Life in the Universe', 'Eega', 'A Better Tomorrow II', 'Tai-Chi Master', 'Wheels on Meals', 'Southern Comfort', 'Max Manus: Man of War', 'Once Upon a Time in China', 'Easy Money', 'Thunderbolt and Lightfoot', 'Vampire Hunter D', 'The Day After', 'Free to Play', 'Bound by Honor', 'Stewie Griffin: The Untold Story', 'In Order of Disappearance', 'The Way of the Dragon', 'THX 1138', 'Resident Evil: Damnation', 'The Girl Who Played with Fire', 'Dawn of the Dead', 'Die Hard: With a Vengeance', 'Fury', 'Kingsman: The Secret Service', 'The Last Kingdom: Seven Kings Must Die', 'Flickering Lights', 'Taxi', 'The Most Dangerous Game', 'Alexander Nevsky', 'The Driver', 'Faster, Pussycat! Kill! Kill!', 'The Stunt Man', 'The Patriot', 'Vada Chennai', 'Ala Vaikunthapurramuloo', 'Little Caesar', 'Vishwaroopam', 'Paan Singh Tomar', 'Let the Bullets Fly', 'A Chinese Ghost Story', 'Shoot to Kill', 'Dragon', 'Bajirao Mastani', 'Sultan', 'Jin-Roh: The Wolf Brigade', 'Armour of God', 'Rob Roy', 'Undisputed II: Last Man Standing', 'Magnum Force', 'Joy Ride', 'Gantz:O', 'Sympathy for Mr. Vengeance', 'The Score', 'eXistenZ', 'The Siege of Jadotville', 'Elite Squad', 'Pineapple Express', 'The Girl with All the Gifts', 'Lone Survivor', 'Allied', 'Dredd', 'This Is the End', 'Prison Break: The Final Break', 'Rocketry: The Nambi Effect', 'Ferry', 'Brotherhood of the Wolf', 'Colors', 'Death Proof', 'Law of Tehran', 'Danger Close: The Battle of Long Tan', 'The Art of Self-Defense', 'Bad Boys for Life', 'Dragged Across Concrete', 'Jigarthanda', 'Kaminey', 'Ashes of Time', 'Badlapur', 'The Mountain II', '13 Tzameti', 'Koi... Mil Gaya', 'The Inglorious Bastards', 'Little Big Soldier', 'The Big Boss', 'JCVD', 'Rumble in the Bronx', 'Felon', 'Jackass Number Two', 'The Wave', 'The Life Aquatic with Steve Zissou', 'The Grey', 'Enemy at the Gates', 'Southpaw', 'American Made', 'The Equalizer', 'Malik', 'Plane', 'Space Sweepers', 'The Stronghold', 'Marco Polo: One Hundred Eyes', '28 Weeks Later', 'Unleashed', 'Curse of the Golden Flower', 'Spartan', 'Get the Gringo', 'Boss Level', 'Major Grom: Plague Doctor', '#Alive', 'Batman: Gotham by Gaslight', 'Birds of Prey (and the Fantabulous Emancipation of One Harley Quinn)', 'Mayhem', 'Atomic Blonde', 'The Vikings', 'The Good Thief', 'Gangster No. 1', 'French Connection II', 'Fifty Dead Men Walking', 'Outrage', 'Fan', 'The Thieves', 'Avalon', 'Paid in Full', 'The Matador', 'Micmacs', 'Witching & Bitching', 'Romper Stomper', 'OSS 117: Lost in Rio', 'Blood and Bone', 'The Edge', 'Heartbreak Ridge', 'Slow West', 'Turbo Kid', 'Harry Brown', 'Patriot Games', 'From Dusk Till Dawn', 'Blood Father', 'Ambulance', 'Copshop', 'Con Air', 'Coffy', 'Wanted', 'Death Wish', 'Master', 'Tanhaji: The Unsung Warrior', 'Sonchiriya', 'Vaaranam Aayiram', 'Thuppakki', 'Intacto', 'The Emerald Forest', 'The Long Riders', 'Heaven & Earth', 'Thursday', 'New Police Story', 'Stretch', 'The Salvation', 'Boyka: Undisputed IV', "The Girl Who Kicked the Hornet's Nest", 'Spy Game', 'RocknRolla', 'Kingdom of Heaven', 'Overlord', 'Man on Fire', 'Blade', 'Kick-Ass', '300', 'Violent Night', 'Lakshya', 'Arlington Road', 'Cop Land', 'Robin-B-Hood', 'Starship Troopers', 'Bullet Train', 'Theeran Adhigaaram Ondru', 'Accident Man', 'Crawl', 'Anthropoid', 'Vikram Vedha', 'Raid', 'War', "Black '47", '21 Bridges', 'Hatari!', 'Confession of Murder', 'Juan of the Dead', 'Admiral', 'Dead Presidents', 'The Protector', 'Three Steps Above Heaven', 'The Legend Is Born: Ip Man', 'Backdraft', 'Ransom', 'Jackass 3D', 'Under Siege', "Shoot 'Em Up", 'Conan the Barbarian', 'Desperado', 'Air Force One', 'Blade II', 'The Heat', 'Sita Ramam', 'Bad Taste', 'Dobermann', 'Death Race 2000', 'Black and Blue', 'The Angel', 'Zombieland: Double Tap', 'Maqbool', 'Golmaal - Fun Unlimited', 'Infernal Affairs III', '9th Company', 'Into the White', 'Dead Snow 2: Red vs. Dead', 'We Own the Night', 'Wheelman', 'The Last Castle', 'Taxi 2', 'Payback', 'Commando', 'Team America: World Police', 'Crank', 'The Boondock Saints', 'Equilibrium', 'Once Upon a Time in Mexico', 'Kiss of the Dragon', 'Aśoka', 'Troy', 'The Hitcher', "The Devil's Double", 'The Kingdom', 'Doodlebug', 'Kaabil', 'Bharat Ane Nenu', 'Sicario: Day of the Soldado', 'Darr', 'Arjun Reddy', 'Sarfarosh', 'Waterloo', 'Don 2', 'Raees', 'Zulu', 'Kill the Irishman', 'Running Scared', 'The Long Kiss Goodnight', 'Fallen', 'The Last Boy Scout', 'God Bless America', 'Highlander', 'Body of Lies', 'Machete', 'Pitch Black', 'The Accountant', 'Rollerball', 'Dhamaal', 'Singham', 'The Brave One', "Cheech & Chong's Next Movie", 'Those Who Wish Me Dead', 'Terminator: Dark Fate', 'Outlaw King', 'The Informer', 'Athadu', 'Baasha', '1: Nenokkadine', 'Deewaar', 'Madras Cafe', 'The Program', 'The Ghazi Attack', 'Subway', 'The Business', 'Crying Freeman', 'Blackthorn', 'The Dark Valley', 'Forsaken', 'The Book of Eli', 'An Action Hero', 'Army of Thieves', 'Day Shift', 'The Punisher: Dirty Laundry', 'Day Watch', 'The Expendables 2', 'Lethal Weapon 3', 'Petta', 'Parmanu: The Story of Pokhran', 'Pokiri', 'Roja', 'Indian', 'Ayan', 'Kaththi', 'Mr. India', 'The Wild Geese', 'Class of 1984', 'Azumi', 'Confidence', 'The Toxic Avenger', 'Conspiracy Theory', 'Free State of Jones', 'Law Abiding Citizen', 'Bad Boys', 'The Protégé', 'AK vs AK', 'Safe House', 'Night Watch', 'The Foreigner', 'Code 8', 'Ratsasan', 'Den of Thieves', 'Kingsman: The Golden Circle', 'Mankatha', 'Theri', 'Kaho Naa... Pyaar Hai', 'The Escapist', 'The Legend of Billie Jean', 'The Way of the Gun', 'The Great Raid', 'Son of a Gun', 'Jackass: The Movie', 'Filth', '13 Hours: The Secret Soldiers of Benghazi', "The Hitman's Bodyguard", 'Big Nothing', 'Bloodsport', 'Exodus', 'Shinobi: Heart Under Blade', 'The Matrix Revolutions', 'Constantine', "Don't Breathe 2", 'Mersal', '12 Strong', 'Irudhi Suttru', 'Oye Lucky! Lucky Oye!', 'Sarkar', 'Mardaani', 'Merantau', 'Aqua Teen Hunger Force Colon Movie Film for Theaters', 'Tales from the Crypt: Demon Knight', 'Rambo', 'Olympus Has Fallen', 'Operation Fortune: Ruse de Guerre', 'The Bodyguard', 'Time Trap', 'Holiday', 'Foxy Brown', 'To End All Wars']
released_movies = check_movies_and_add_to_list(movie_title)
print(released_movies)
